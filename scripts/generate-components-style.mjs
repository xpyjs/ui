import fs from 'fs'

const COMPONENTS_DIR = './packages/styles/components'
const OUTPUT_FILE = './packages/styles/components/_index.scss'

const ignoreComponents = ['_index.scss']

function generateComponentsStyle() {
    // 读取 components 目录下的所有文件夹
    const components = fs
        .readdirSync(COMPONENTS_DIR, { withFileTypes: true })
        .filter(dirent => dirent.isFile() && !ignoreComponents.includes(dirent.name))
        .map(dirent => dirent.name.replace('.scss', ''))

    // 生成声明文件内容
    const content = `// This file is generated by scripts/generate-components-style.mjs

${components.map(component => `@use "${component}";`).join('\n')}
`

    // 写入文件
    fs.writeFileSync(OUTPUT_FILE, content, 'utf-8')
    console.log('\x1b[32m【BUILD】Generated components.scss successfully!\x1b[0m')
}

generateComponentsStyle()